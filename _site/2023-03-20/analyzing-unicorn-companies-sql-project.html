<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>M.A.</title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" type="text/css" href="/assets/css/fontawesome-all.min.css">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon.ico">

  <!-- Google Analytics -->
  
  <script>
      (function(i, s, o, g, r, a, m) {
          i['GoogleAnalyticsObject'] = r;
          i[r] = i[r] || function() {
              (i[r].q = i[r].q || []).push(arguments)
          }, i[r].l = 1 * new Date();
          a = s.createElement(o),
              m = s.getElementsByTagName(o)[0];
          a.async = 1;
          a.src = g;
          m.parentNode.insertBefore(a, m)
      })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'G-NKY0QRYQND', 'auto');
      ga('send', 'pageview');

  </script>
  

</head>


  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/">
          <h2 class="nav-title">M.A.</h2>
        </a>
        <ul>
          <li><a href="/">About</a></li>
          <li><a href="/portfolio/">Portfolio</a></li>
        </ul>
    </div>
  </nav>

    <main>
      <div class="post">
  <h2 class="post-title">Analyzing Unicorn Companies</h2>
  <div class="post-line"></div>

  <p>Analyzing Unicorns Companies is a DataCamp unguided SQL project that intends to find the number of companies that achieved unicorn status (values exceeding USD 1 billion) between 2019 and 2021. Check out <a href="https://github.com/mohammad-agus/analyzing_unicorn_companies_sql_project">my GitHub repository</a> or <a href="https://app.datacamp.com/learn/projects/1531">project page</a> to download the datasets.</p>

<h1 id="tables">Tables</h1>
<p>Given is the <code class="language-plaintext highlighter-rouge">unicorns</code> database, which contains the following tables, for this projectâ€™s dataset sources.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">dates</code> table</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>company_id</td>
      <td>A unique ID for the company.</td>
    </tr>
    <tr>
      <td>date_joined</td>
      <td>The date that the company became a unicorn.</td>
    </tr>
    <tr>
      <td>year_founded</td>
      <td>The year that the company was founded.</td>
    </tr>
  </tbody>
</table>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">dates</span>
<span class="k">LIMIT</span> <span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023_analyzing_unicorn_companies/dates.png" alt="Expected result" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">funding</code> table</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>company_id</td>
      <td>A unique ID for the company.</td>
    </tr>
    <tr>
      <td>valuation</td>
      <td>Company value in US dollars.</td>
    </tr>
    <tr>
      <td>funding</td>
      <td>The amount of funding raised in US dollars.</td>
    </tr>
    <tr>
      <td>select_investors</td>
      <td>A list of key investors in the company.</td>
    </tr>
  </tbody>
</table>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">funding</span>
<span class="k">LIMIT</span> <span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023_analyzing_unicorn_companies/funding.png" alt="Expected result" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">industries</code> table</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>company_id</td>
      <td>A unique ID for the company.</td>
    </tr>
    <tr>
      <td>industry</td>
      <td>The industry that the company operates in.</td>
    </tr>
  </tbody>
</table>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">industries</span>
<span class="k">LIMIT</span> <span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023_analyzing_unicorn_companies/industries.png" alt="Expected result" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">companies</code> table</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>company_id</td>
      <td>A unique ID for the company.</td>
    </tr>
    <tr>
      <td>company</td>
      <td>The name of the company.</td>
    </tr>
    <tr>
      <td>city</td>
      <td>The city where the company is headquartered.</td>
    </tr>
    <tr>
      <td>country</td>
      <td>The country where the company is headquartered.</td>
    </tr>
    <tr>
      <td>continent</td>
      <td>The continent where the company is headquartered.</td>
    </tr>
  </tbody>
</table>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">companies</span>
<span class="k">LIMIT</span> <span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023_analyzing_unicorn_companies/companies.png" alt="Expected result" /></p>

<h1 id="tasks">Tasks</h1>
<ul>
  <li>Identify the three best-performing industries based on the number of new unicorns created between 2019 and 2021 combined.</li>
  <li>Write a query to return the industry, the year, and the number of companies in these industries that became unicorns each year in 2019, 2020, and 2021, along with the average valuation per industry per year, converted to billions of dollars and rounded to two decimal places!</li>
  <li>Display the result by industry, then the year in descending order.</li>
</ul>

<p>The final output of the query will look like this:
<br /></p>

<p><img src="/assets/2023_analyzing_unicorn_companies/expected_result.png" alt="Expected result" /></p>

<p>Where industry1, industry2, and industry3 are the three top-performing industries.
<br /></p>

<h1 id="query-and-result">Query and Result</h1>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
	<span class="n">i</span><span class="p">.</span><span class="n">industry</span><span class="p">,</span>
	<span class="k">EXTRACT</span><span class="p">(</span><span class="nb">YEAR</span> <span class="k">FROM</span> <span class="n">d</span><span class="p">.</span><span class="n">date_joined</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">year</span><span class="p">,</span>
	<span class="k">COUNT</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">company_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num_unicorns</span><span class="p">,</span>
	<span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">valuation</span><span class="o">/</span><span class="mi">1000000000</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="k">AS</span> <span class="n">average_valuation_billions</span>
<span class="k">FROM</span> <span class="n">companies</span> <span class="k">c</span>
	<span class="c1">-- inner join companies with industries, dates and funding table</span>
	<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">industries</span> <span class="n">i</span> <span class="k">USING</span><span class="p">(</span><span class="n">company_id</span><span class="p">)</span>
	<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dates</span> <span class="n">d</span> <span class="k">USING</span><span class="p">(</span><span class="n">company_id</span><span class="p">)</span>
	<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">funding</span> <span class="n">f</span> <span class="k">USING</span><span class="p">(</span><span class="n">company_id</span><span class="p">)</span>
<span class="k">WHERE</span>
	<span class="c1">-- extract the year from d.date_joined, then filter the years 2019 - 2021</span>
	<span class="k">EXTRACT</span><span class="p">(</span><span class="nb">YEAR</span> <span class="k">FROM</span> <span class="n">d</span><span class="p">.</span><span class="n">date_joined</span><span class="p">)</span> <span class="k">BETWEEN</span> <span class="mi">2019</span> <span class="k">AND</span> <span class="mi">2021</span>
	
	<span class="c1">-- filter the top 3 industries based on the number of new unicorns</span>
	 <span class="k">AND</span> <span class="n">i</span><span class="p">.</span><span class="n">industry</span> <span class="k">IN</span> <span class="p">(</span>
		<span class="k">SELECT</span> <span class="n">i</span><span class="p">.</span><span class="n">industry</span>
		<span class="k">FROM</span> 
			<span class="n">companies</span> <span class="k">c</span>
			<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">industries</span> <span class="n">i</span> <span class="k">ON</span> <span class="k">c</span><span class="p">.</span><span class="n">company_id</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="n">company_id</span>
			<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dates</span> <span class="n">d</span> <span class="k">ON</span> <span class="k">c</span><span class="p">.</span><span class="n">company_id</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">company_id</span>
		<span class="k">WHERE</span>
			<span class="k">EXTRACT</span><span class="p">(</span><span class="nb">YEAR</span> <span class="k">FROM</span> <span class="n">d</span><span class="p">.</span><span class="n">date_joined</span><span class="p">)</span> <span class="k">BETWEEN</span> <span class="mi">2019</span> <span class="k">AND</span> <span class="mi">2021</span>
		<span class="k">GROUP</span> <span class="k">BY</span> 
			<span class="n">i</span><span class="p">.</span><span class="n">industry</span><span class="p">,</span> 
			<span class="k">EXTRACT</span><span class="p">(</span><span class="nb">YEAR</span> <span class="k">FROM</span> <span class="n">d</span><span class="p">.</span><span class="n">date_joined</span><span class="p">)</span>
		<span class="k">ORDER</span> <span class="k">BY</span> 
			<span class="k">COUNT</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">company_id</span><span class="p">)</span> <span class="k">DESC</span>
		<span class="k">LIMIT</span> <span class="mi">3</span><span class="p">)</span>

<span class="k">GROUP</span> <span class="k">BY</span> 
	<span class="n">i</span><span class="p">.</span><span class="n">industry</span><span class="p">,</span>
	<span class="k">EXTRACT</span><span class="p">(</span><span class="nb">YEAR</span> <span class="k">FROM</span> <span class="n">d</span><span class="p">.</span><span class="n">date_joined</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
	<span class="n">i</span><span class="p">.</span><span class="n">industry</span><span class="p">,</span>
	<span class="nb">year</span> <span class="k">DESC</span><span class="p">;</span>

</code></pre></div></div>

<p><img src="/assets/2023_analyzing_unicorn_companies/result.png" alt="Expected result" /></p>


</div>

<div class="pagination">
  
    <a href="/2023-04-29/hr-analytics-using-sql-and-powerbi" class="left next">Prev</a>
  
  
    <a href="/2023-03-12/performing-linear_regression_ordinary_least_square_using_python_statsmodels" class="right next">Next</a>
  

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
      <span>
        &copy; <time datetime="2023-06-05 01:29:53 +0800">2023</time> <!--Moh. Agus. <a href="https://github.com/kssim/about-portfolio/">A.P</a> theme by kssim.-->
      </span>
    </footer>
  </body>
</html>
